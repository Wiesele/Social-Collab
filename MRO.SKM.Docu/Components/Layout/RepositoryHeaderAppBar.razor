@using MRO.SMK.SDK.Models
@inject IJSRuntime JS
@inject RepositoryService RepositoryService;
@inject LoaderService loader;


<MudThemeProvider @ref="MudThemeProvider" @bind-IsDarkMode="@IsDarkMode"/>


<MudAppBar Elevation="1">
    <MudText Typo="Typo.h5" Class="ml-3">
        @(Repository != null ? this.Repository.Name : "")
    </MudText>
    <MudTooltip Text="Repository neu laden" Style="margin-left: 25px">
        <MudIconButton Icon="@Icons.Material.Filled.Refresh" Color="Color.Inherit" OnClick="ReloadRepository"></MudIconButton>
    </MudTooltip>
    <MudSpacer/>
    <MudIconButton Icon="@Icons.Material.Filled.Notifications" Color="@Color.Inherit"></MudIconButton>
    <MudToggleIconButton @bind-Toggled="IsDarkMode"
                         Icon="@Icons.Material.Filled.DarkMode" Color="@Color.Inherit"
                         ToggledIcon="@Icons.Material.Filled.LightMode" ToggledColor="@Color.Inherit"/>
</MudAppBar>



@code {
    [Parameter] public Repository? Repository { get; set; }
    public bool IsDarkMode;
    public required MudThemeProvider MudThemeProvider;

    private bool IsDownloading = false;

    void ChangeDarkMode()
    {
        IsDarkMode = !IsDarkMode;
    }

    async Task ReloadRepository()
    {
        await this.loader.ShowLoader("Lade Codestruktur");
        await this.RepositoryService.ReloadRepository(this.Repository);
        this.loader.HideLoader();
    }       
}